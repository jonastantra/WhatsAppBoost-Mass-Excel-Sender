<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WA Sender Pro</title>
  <link rel="stylesheet" href="sidebar.css">
  <!-- SheetJS para Excel - LOCAL (CSP compliant) -->
  <script src="libs/xlsx.full.min.js"></script>
</head>
<body>
  <div class="was-app">
    
    <!-- ============================================ -->
    <!-- PANTALLA DE CARGA -->
    <!-- ============================================ -->
    <div id="loading-screen" class="was-screen was-loading-screen">
      <div class="was-loading-content">
        <div class="was-loading-logo">
          <svg viewBox="0 0 24 24" width="64" height="64">
            <path fill="#00a884" d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"/>
          </svg>
        </div>
        <div class="was-spinner"></div>
        <p class="was-loading-title" data-i18n="appName">WA Sender Pro</p>
        <p class="was-loading-message" id="loading-message" data-i18n="loadingInitializing">Initializing...</p>
        <div class="was-loading-steps" id="loading-steps">
          <div class="was-step" id="step-find">
            <span class="was-step-icon">â—‹</span>
            <span class="was-step-text" data-i18n="loadingSearchingWhatsApp">Searching WhatsApp Web</span>
          </div>
          <div class="was-step" id="step-connect">
            <span class="was-step-icon">â—‹</span>
            <span class="was-step-text" data-i18n="loadingConnecting">Connecting</span>
          </div>
          <div class="was-step" id="step-ready">
            <span class="was-step-icon">â—‹</span>
            <span class="was-step-text" data-i18n="loadingReady">Ready</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- PANTALLA DE QR REQUERIDO -->
    <!-- ============================================ -->
    <div id="qr-screen" class="was-screen was-qr-screen" style="display: none;">
      <div class="was-qr-content">
        <svg class="was-qr-icon" viewBox="0 0 24 24" width="72" height="72">
          <path fill="#3b82f6" d="M3 11h8V3H3v8zm2-6h4v4H5V5zm8-2v8h8V3h-8zm6 6h-4V5h4v4zM3 21h8v-8H3v8zm2-6h4v4H5v-4zm13 2h-2v2h2v2h-4v-4h2v-2h2v2zm0 2h2v2h-2v-2zm-4 2h2v-2h-2v2zm4-8h2v2h2v-2h-2V9h-2v2z"/>
        </svg>
        <h3 class="was-qr-title" data-i18n="qrTitle">Scan the QR code</h3>
        <p class="was-qr-message" data-i18n="qrMessage">Open WhatsApp on your phone and scan the QR code to continue.</p>
        <div class="was-qr-instructions">
          <p data-i18n="qrStep1">1. Open WhatsApp on your phone</p>
          <p data-i18n-html="qrStep2">2. Tap <strong>Menu</strong> or <strong>Settings</strong></p>
          <p data-i18n-html="qrStep3">3. Select <strong>Linked devices</strong></p>
          <p data-i18n-html="qrStep4">4. Tap <strong>Link a device</strong></p>
        </div>
        <button class="was-btn was-btn-primary" id="qr-retry-btn">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
          </svg>
          <span data-i18n="btnVerifyConnection">Verify connection</span>
        </button>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- PANTALLA DE ERROR -->
    <!-- ============================================ -->
    <div id="error-screen" class="was-screen was-error-screen" style="display: none;">
      <div class="was-error-content">
        <svg class="was-error-icon" viewBox="0 0 24 24" width="64" height="64">
          <path fill="#ef4444" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        <h3 class="was-error-title" data-i18n="errorTitle">Connection Error</h3>
        <p class="was-error-message" id="error-message" data-i18n="errorDefaultMessage">Could not connect to WhatsApp Web</p>
        <div class="was-error-actions">
          <button class="was-btn was-btn-primary" id="error-retry-btn">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
              <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
            <span data-i18n="btnRetry">Retry</span>
          </button>
          <button class="was-btn was-btn-secondary" id="error-open-btn">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
              <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
            </svg>
            <span data-i18n="btnOpenWhatsAppWeb">Open WhatsApp Web</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- UI PRINCIPAL -->
    <!-- ============================================ -->
    <div id="main-ui" class="was-main-container" style="display: none;">
      
      <!-- Header -->
      <header class="was-header">
        <div class="was-logo">
          <div class="was-logo-icon">
            <svg viewBox="0 0 24 24" width="28" height="28">
              <path fill="#fff" d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"/>
            </svg>
          </div>
          <span class="was-logo-text" data-i18n="appName">WA Sender Pro</span>
        </div>
        <button class="was-send-float" id="quick-send-btn" data-i18n-title="quickSendTitle" title="Quick send">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
          </svg>
        </button>
      </header>

      <!-- Status Bar -->
      <div class="was-status-bar" id="status-bar">
        <span class="was-status-dot"></span>
        <span class="was-status-text" data-i18n="statusConnected">Connected to WhatsApp Web</span>
      </div>

      <!-- Tabs Navigation -->
      <nav class="was-tabs">
        <button class="was-tab active" data-tab="tab-manual">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
          <span data-i18n="tabManual">Manual</span>
        </button>
        <button class="was-tab" data-tab="tab-excel">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/></svg>
          <span data-i18n="tabExcel">Excel/CSV</span>
        </button>
        <button class="was-tab" data-tab="tab-groups">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
          <span data-i18n="tabGroups">Groups</span>
        </button>
        <button class="was-tab" data-tab="tab-settings">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
          <span data-i18n="tabSettings">Settings</span>
        </button>
      </nav>

      <!-- Main Content -->
      <main class="was-main">
        <!-- TAB: MANUAL -->
        <section id="tab-manual" class="was-tab-content active">
          <div class="was-card">
            <div class="was-card-header">
              <h3 data-i18n="addNumbers">Add Numbers</h3>
            </div>
            <div class="was-card-body">
              <div class="was-input-row">
                <input type="text" class="was-input" id="number-input" placeholder="+521234567890">
                <button class="was-btn was-btn-icon" id="add-number-btn" data-i18n-title="addTitle" title="Add">
                  <svg viewBox="0 0 24 24" width="20" height="20"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                </button>
              </div>
              
              <div class="was-contact-list" id="contact-list">
                <div class="was-empty-state">
                  <svg viewBox="0 0 24 24" width="48" height="48" opacity="0.3"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
                  <p data-i18n="noContactsAdded">No contacts added</p>
                </div>
              </div>

              <div class="was-actions-row">
                <button class="was-btn was-btn-outline" id="clear-contacts-btn">
                  <svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                  <span data-i18n="clearList">Clear List</span>
                </button>
                <span class="was-contact-count"><span data-i18n="totalLabel">Total:</span> <strong id="total-contacts">0</strong></span>
              </div>
            </div>
          </div>
        </section>

        <!-- TAB: EXCEL/CSV -->
        <section id="tab-excel" class="was-tab-content">
          <!-- Instrucciones -->
          <div class="was-card was-card-info">
            <div class="was-card-body">
              <div class="was-info-header">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="#3b82f6">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                </svg>
                <h4 data-i18n="howToUseTemplates">How to use templates?</h4>
              </div>
              <ol class="was-instructions">
                <li data-i18n="templateStep1">Download the example template</li>
                <li data-i18n="templateStep2">Fill in your contacts data</li>
                <li data-i18n="templateStep3">Upload the file here</li>
              </ol>
            </div>
          </div>

          <!-- Botones de Descarga de Plantilla -->
          <div class="was-card">
            <div class="was-card-header">
              <h3 data-i18n="downloadTemplate">ðŸ“¥ Download Template</h3>
            </div>
            <div class="was-card-body">
              <div class="was-template-buttons">
                <button class="was-btn was-btn-excel" id="download-excel-btn">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/>
                    <path d="M8 12h3v2H8v-2zm0 3h3v2H8v-2zm5-3h3v2h-3v-2zm0 3h3v2h-3v-2z"/>
                  </svg>
                  <span>
                    <strong data-i18n="excelXlsx">Excel (.xlsx)</strong>
                    <small data-i18n="recommended">Recommended</small>
                  </span>
                </button>
                <button class="was-btn was-btn-csv" id="download-csv-btn">
                  <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/>
                  </svg>
                  <span>
                    <strong data-i18n="csvLabel">CSV</strong>
                    <small data-i18n="simple">Simple</small>
                  </span>
                </button>
              </div>
              
              <div class="was-template-info">
                <p><strong data-i18n="availableColumns">Available columns:</strong></p>
                <div class="was-column-tags">
                  <span class="was-tag was-tag-required">phone</span>
                  <span class="was-tag">name</span>
                  <span class="was-tag">var1</span>
                  <span class="was-tag">var2</span>
                  <span class="was-tag">var3</span>
                </div>
                <p class="was-hint" data-i18n-html="phoneColumnRequired">The <code>phone</code> column is required</p>
              </div>
            </div>
          </div>

          <!-- Zona de Subida -->
          <div class="was-card">
            <div class="was-card-header">
              <h3 data-i18n="uploadFile">ðŸ“¤ Upload File</h3>
            </div>
            <div class="was-card-body">
              <div class="was-upload-zone" id="upload-zone">
                <input type="file" id="file-input" accept=".xlsx,.xls,.csv,.txt" hidden>
                <div class="was-upload-content">
                  <div class="was-upload-icon">
                    <svg viewBox="0 0 24 24" width="48" height="48">
                      <path fill="#94a3b8" d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/>
                    </svg>
                  </div>
                  <p class="was-upload-text" data-i18n="dragFileHere">Drag your file here</p>
                  <p class="was-upload-or" data-i18n="orDivider">â€” or â€”</p>
                  <button class="was-btn was-btn-primary" id="select-file-btn" data-i18n="selectFile">
                    Select File
                  </button>
                  <p class="was-upload-hint" data-i18n="uploadHint">Excel (.xlsx, .xls), CSV, TXT â€” Max 5MB</p>
                </div>
              </div>

              <!-- Vista previa del archivo -->
              <div class="was-file-preview" id="file-preview" style="display: none;">
                <div class="was-file-icon" id="file-icon">
                  <svg viewBox="0 0 24 24" width="32" height="32">
                    <path fill="#16a34a" d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6z"/>
                  </svg>
                </div>
                <div class="was-file-details">
                  <span class="was-file-name" id="file-name">archivo.xlsx</span>
                  <span class="was-file-size" id="file-size">0 KB</span>
                </div>
                <button class="was-btn was-btn-icon was-btn-danger" id="remove-file-btn" data-i18n-title="removeTitle" title="Remove">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                  </svg>
                </button>
              </div>

              <!-- Resultado de importaciÃ³n -->
              <div id="import-result" class="was-import-result" style="display: none;"></div>

              <!-- Vista previa de contactos importados -->
              <div id="import-preview" class="was-import-preview" style="display: none;">
                <div class="was-preview-header">
                  <h4 data-i18n="preview">Preview</h4>
                  <span class="was-preview-count" id="preview-count">0 contacts</span>
                </div>
                <div class="was-preview-table" id="preview-table">
                  <!-- Se genera dinÃ¡micamente -->
                </div>
                <div class="was-preview-actions">
                  <button class="was-btn was-btn-outline" id="cancel-import-btn" data-i18n="btnCancel">Cancel</button>
                  <button class="was-btn was-btn-primary" id="confirm-import-btn">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    <span data-i18n="btnImportContacts">Import Contacts</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- TAB: GROUPS -->
        <section id="tab-groups" class="was-tab-content">
          <!-- Instrucciones -->
          <div class="was-card was-card-warning">
            <div class="was-card-body">
              <div class="was-group-instructions">
                <div class="was-instruction-header">
                  <svg viewBox="0 0 24 24" width="28" height="28" fill="#f59e0b">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                  </svg>
                  <h4 data-i18n="extractGroupMembers">Extract Group Members</h4>
                </div>
                <ol class="was-steps-list">
                  <li>
                    <span class="was-step-num">1</span>
                    <span data-i18n-html="groupStep1">Open a <strong>group</strong> in WhatsApp Web</span>
                  </li>
                  <li>
                    <span class="was-step-num">2</span>
                    <span data-i18n-html="groupStep2">Click on the <strong>group name</strong> (top)</span>
                  </li>
                  <li>
                    <span class="was-step-num">3</span>
                    <span data-i18n-html="groupStep3">Scroll to see the <strong>participants list</strong></span>
                  </li>
                  <li>
                    <span class="was-step-num">4</span>
                    <span data-i18n="groupStep4">Click the button below</span>
                  </li>
                </ol>
              </div>
            </div>
          </div>

          <!-- BotÃ³n Principal -->
          <div class="was-card">
            <div class="was-card-body">
              <button class="was-btn was-btn-group was-btn-full" id="scrape-group-btn">
                <div class="was-btn-icon-wrapper">
                  <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                  </svg>
                </div>
                <div class="was-btn-text">
                  <strong data-i18n="getGroupMembers">Get Group Members</strong>
                  <small data-i18n="extractNumbersFromGroup">Extract numbers from the open group</small>
                </div>
              </button>

              <!-- Estado de extracciÃ³n -->
              <div id="group-extract-status" class="was-extract-status" style="display: none;">
                <div class="was-extract-spinner"></div>
                <span id="group-extract-message" data-i18n="searchingMembers">Searching members...</span>
              </div>
            </div>
          </div>

          <!-- Vista previa de miembros -->
          <div id="group-members-preview" class="was-card" style="display: none;">
            <div class="was-card-header">
              <h3 data-i18n="membersFound">ðŸ‘¥ Members Found</h3>
              <span class="was-badge was-badge-success" id="members-count">0</span>
            </div>
            <div class="was-card-body">
              <div class="was-members-list" id="members-list">
                <!-- Se genera dinÃ¡micamente -->
              </div>
              <div class="was-preview-actions">
                <button class="was-btn was-btn-outline" id="cancel-group-import-btn" data-i18n="btnCancel">
                  Cancel
                </button>
                <button class="was-btn was-btn-primary" id="confirm-group-import-btn">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                  </svg>
                  <span data-i18n="btnAddToList">Add to List</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Disclaimer -->
          <div class="was-disclaimer">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
            </svg>
            <p><strong data-i18n="responsibleUse">Responsible Use:</strong> <span data-i18n="disclaimerText">This feature is for personal use. Do not use extracted numbers for spam. Respect WhatsApp policies.</span></p>
          </div>
        </section>

        <!-- TAB: SETTINGS -->
        <section id="tab-settings" class="was-tab-content">
          <div class="was-card">
            <div class="was-card-header">
              <h3 data-i18n="sendingConfig">Sending Configuration</h3>
            </div>
            <div class="was-card-body">
              <div class="was-setting-row">
                <div class="was-setting-info">
                  <span class="was-setting-label" data-i18n="sendingInterval">Sending interval</span>
                  <span class="was-setting-desc" data-i18n="sendingIntervalDesc">Messages will be sent randomly in this range</span>
                </div>
                <div class="was-interval-inputs">
                  <button class="was-interval-btn" data-action="decrease" data-target="delay-min">âˆ’</button>
                  <input type="number" class="was-interval-input" id="delay-min" value="6" min="1" max="60">
                  <span class="was-interval-sep">~</span>
                  <input type="number" class="was-interval-input" id="delay-max" value="10" min="1" max="120">
                  <button class="was-interval-btn" data-action="increase" data-target="delay-max">+</button>
                  <span class="was-interval-unit" data-i18n="secondsUnit">sec</span>
                </div>
              </div>

              <div class="was-setting-toggle">
                <div class="was-setting-info">
                  <span class="was-setting-label" data-i18n="antiBanLabel">Anti-Ban (unique ID)</span>
                  <span class="was-setting-desc" data-i18n="antiBanDesc">Adds a unique identifier to each message</span>
                </div>
                <label class="was-switch">
                  <input type="checkbox" id="anti-ban-toggle">
                  <span class="was-switch-slider"></span>
                </label>
              </div>

              <div class="was-setting-toggle">
                <div class="was-setting-info">
                  <span class="was-setting-label" data-i18n="deleteChatLabel">Delete chat after sending</span>
                  <span class="was-setting-desc" data-i18n="deleteChatDesc">Archives the chat automatically</span>
                </div>
                <label class="was-switch">
                  <input type="checkbox" id="delete-after-toggle">
                  <span class="was-switch-slider"></span>
                </label>
              </div>

              <div class="was-setting-toggle">
                <div class="was-setting-info">
                  <span class="was-setting-label" data-i18n="timestampLabel">Add timestamp</span>
                  <span class="was-setting-desc" data-i18n="timestampDesc">Adds the time at the end of the message</span>
                </div>
                <label class="was-switch">
                  <input type="checkbox" id="timestamp-toggle">
                  <span class="was-switch-slider"></span>
                </label>
              </div>
            </div>
          </div>

          <div class="was-card">
            <div class="was-card-header">
              <h3 data-i18n="statistics">Statistics</h3>
            </div>
            <div class="was-card-body">
              <div class="was-stats-grid">
                <div class="was-stat-item was-stat-success">
                  <span class="was-stat-value" id="stat-sent">0</span>
                  <span class="was-stat-label" data-i18n="sentLabel">Sent</span>
                </div>
                <div class="was-stat-item was-stat-error">
                  <span class="was-stat-value" id="stat-failed">0</span>
                  <span class="was-stat-label" data-i18n="failedLabel">Failed</span>
                </div>
                <div class="was-stat-item was-stat-pending">
                  <span class="was-stat-value" id="stat-pending">0</span>
                  <span class="was-stat-label" data-i18n="pendingLabel">Pending</span>
                </div>
              </div>
              <button class="was-btn was-btn-outline was-btn-full" id="reset-stats-btn" data-i18n="resetStats">
                Reset Statistics
              </button>
            </div>
          </div>
        </section>

        <!-- MESSAGE COMPOSER (Always visible) -->
        <div class="was-composer">
          <div class="was-composer-header">
            <h3 data-i18n="messageLabel">Message</h3>
            <button class="was-test-link" id="test-message-btn">
              <span class="was-test-dot"></span>
              <span data-i18n="testMessage">Test message</span>
            </button>
          </div>

          <!-- Templates -->
          <div class="was-template-row">
            <select class="was-select" id="template-select">
              <option value="" data-i18n="selectTemplate">Select template...</option>
            </select>
            <button class="was-btn was-btn-icon" id="save-template-btn" data-i18n-title="saveTemplateTitle" title="Save template">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
            </button>
            <button class="was-btn was-btn-icon was-btn-danger" id="delete-template-btn" data-i18n-title="deleteTemplateTitle" title="Delete template" style="display: none;">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            </button>
          </div>

          <!-- Variables -->
          <div class="was-variables">
            <span class="was-variables-label" data-i18n="variablesLabel">Variables:</span>
            <button class="was-variable-btn" data-var="{{numero}}" data-i18n="varNumber">Number</button>
            <button class="was-variable-btn" data-var="{{nombre}}" data-i18n="varName">Name</button>
            <button class="was-variable-btn" data-var="{{fecha}}" data-i18n="varDate">Date</button>
          </div>

          <!-- Toolbar -->
          <div class="was-toolbar">
            <div class="was-format-btns">
              <button class="was-format-btn" data-format="*" data-i18n-title="boldTitle" title="Bold"><b>B</b></button>
              <button class="was-format-btn" data-format="_" data-i18n-title="italicTitle" title="Italic"><i>I</i></button>
              <button class="was-format-btn" data-format="~" data-i18n-title="strikeTitle" title="Strikethrough"><s>S</s></button>
              <button class="was-format-btn" data-format="```" data-i18n-title="codeTitle" title="Code"><code>&lt;/&gt;</code></button>
            </div>
            <label class="was-attach-btn">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/></svg>
              <span data-i18n="attachLabel">Attach</span>
              <input type="file" id="attachment-input" hidden accept="image/*,video/*,.pdf,.doc,.docx">
            </label>
          </div>

          <!-- Attachment Preview -->
          <div class="was-attachment-preview" id="attachment-preview" style="display: none;">
            <div class="was-attachment-info">
              <svg id="attachment-icon" viewBox="0 0 24 24" width="20" height="20"></svg>
              <span id="attachment-name">archivo.jpg</span>
            </div>
            <button class="was-remove-btn" id="remove-attachment-btn">âœ•</button>
          </div>

          <!-- Send Order Option -->
          <div class="was-send-order-option" id="send-order-option" style="display: none;">
            <label class="was-checkbox-label">
              <input type="checkbox" id="send-attachment-first" checked>
              <span class="was-checkmark"></span>
              <span data-i18n="sendAttachmentFirst">ðŸ“· Enviar adjunto primero, luego el texto</span>
            </label>
            <p class="was-helper-text" data-i18n="attachmentOrderHint">Recomendado: Los mensajes se ven mejor cuando la imagen llega primero</p>
          </div>

          <!-- Text Area -->
          <textarea class="was-textarea" id="message-input" data-i18n-placeholder="messagePlaceholder" placeholder="Write your message here...

Use variables like {{numero}} to personalize each message."></textarea>

          <!-- Quick Actions -->
          <div class="was-quick-actions">
            <button class="was-quick-btn" id="add-apology-btn" data-i18n="apologyButton">Sorry for the inconvenience</button>
            <button class="was-quick-btn" id="add-timestamp-btn" data-i18n="addTimestampBtn">+ Timestamp</button>
          </div>
        </div>
      </main>

      <!-- Action Buttons -->
      <footer class="was-footer">
        <button class="was-btn was-btn-send" id="send-btn">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
          </svg>
          <span data-i18n="sendMessages">Send Messages</span>
        </button>
        <button class="was-btn was-btn-stop" id="stop-btn" style="display: none;">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
            <path d="M6 6h12v12H6z"/>
          </svg>
          <span id="stop-btn-text" data-i18n="stopSending">Stop Sending</span>
        </button>
        
        <!-- Progress Bar -->
        <div class="was-progress" id="progress-container" style="display: none;">
          <div class="was-progress-bar" id="progress-bar"></div>
          <span class="was-progress-text" id="progress-text">0 / 0</span>
        </div>

        <div class="was-footer-info">
          <span>WA Sender Pro v2.2</span>
          <a href="#" id="show-stats-link" data-i18n="viewStats">View statistics â†’</a>
        </div>
      </footer>
    </div>
  </div>

  <script src="sidebar.js"></script>
</body>
</html>
